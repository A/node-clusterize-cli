#!/usr/bin/env node
'use strict';

/**
 * Module dependencies.
 */

var program        = require('commander');
var pkg            = require('../package.json');
var path           = require('path');
var Daemonize         = require('../lib/node-daemonize');
var tmpdir         = require('os').tmpdir();

// End of Dependencies


var config         = {};


program
  .version(pkg.version)
  .option('list', 'list of running daemons')
  .option('start', 'Start new daemon')
  .option('stop <pid>', 'Stop daemon')
  .option('-c, --config <path>', 'Add config path')
  .option('-a, --app <path>', 'Add path to demonizing app')
  .option('-w, --workers <q>', 'Set quantity of workers for your app')
  .option('-l, --log <path>', 'Add path to demonizing app')
  .parse(process.argv);

// console.log(program);
if (program.config) config = require(path.resolve(program.config));
if (program.app) config.app = path.resolve(program.app);
if (program.workers) config.workers = program.workers;
if (program.log) config.log = program.log;

// setup config by inline args

if (program.start) {
  process.nextTick(function () {
    new Daemonize(config);
  });
  
}
// if (program.stop) { /* stop daemon by pid */  }
// if (program.list) { /* log.(daemons.list) */  }
